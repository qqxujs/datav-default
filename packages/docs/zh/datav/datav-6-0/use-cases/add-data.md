  为地图时间轴等组件配置数据源-DataV数据可视化-阿里云

本文档为您介绍在DataV可视化应用中，为组件添加数据的方法。

## 添加地图数据

1.  在画布编辑器页面，单击选中**基础平面地图**组件。
2.  在右侧的**数据**面板中，单击**等值面层**。
3.  在**等值面层**的**数据**面板中，单击**插值点数据接口**。
    
    ![配置](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/0202584561/p448548.png)
    
    **说明** **等值面层**的数据包括了**裁剪边界数据接口**数据和**插值点数据接口**数据。由于本示例的数据区域是全国范围，因此**裁剪边界数据接口**的数据可以保持不变。您也可以根据需要修改**裁剪边界数据接口**的数据。
    
4.  在**插值点数据接口**的配置页面，单击**配置数据源**。
5.  在**设置数据源**页面，按照以下说明配置数据源。
    
    -   **数据源类型**：选择**API**。由于[处理接口](https://help.aliyun.com/zh/datav/datav-6-0/use-cases/process-apis#concept-lgr-rtq-p2b)章节已经写好了对应的API，也已经测试了数据获取，所以修改**等值面层**组件的插值点的**数据源类型**为**API**。
    -   **URL**：填写[处理接口](https://help.aliyun.com/zh/datav/datav-6-0/use-cases/process-apis#concept-lgr-rtq-p2b)中测试的地址（本文测试http://127.0.0.1:8888/aqi?date=2017012722）。
    
6.  单击**预览数据源返回结果**，查看数据返回结果。
7.  单击**数据响应结果**右侧的**刷新**图标，查看数据响应结果。
    
    数据响应成功后，组件将在画布上展示对应的数据样式。
    
8.  退出**设置数据源**页面，按照以下说明，设置**等值面层**组件的配置样式。
    1.  在**等值面层**的**配置**页面，单击右侧面板的**配置**。
    2.  在**配置**面板中，设置**像元大小**，推荐设置为**3**。
        
        ![设置像元大小](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9431839061/p9288.png)
        
        **重要** 像元大小越大，插值越快，精度越低。
        
    3.  设置**渲染方式**，推荐设置为**线性渲染**。
        
        ![设置渲染方式](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9431839061/p9289.png)
        
    4.  设置**分类数目**，推荐设置为**35**。
        
        ![设置分类数目](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9431839061/p9290.png)
        

## 添加时间轴数据

1.  在画布编辑器页面，单击选中**时间轴**组件。
2.  在右侧的**数据**面板中，单击**配置数据源**。
3.  在**设置数据源**页面，选择**数据源类型**为**静态数据**。
4.  参考**时间轴**组件的默认数据，创建您需要的数据，并替换示例静态数据。
    
    例如，选择2017年1月22日到2017年2月2日，每天22点作为时间轴数据。
    
    ```
    [
    {
     "name": "2017年1月22日22时",
     "date": 2017012222,
     "value": 2017012222
    },
    {
     "name": "2017年1月23日22时",
     "date": 2017012322,
     "value": 2017012322
    },
    {
     "name": "2017年1月24日22时",
     "date": 2017012422,
     "value": 2017012422
    },
    {
     "name": "2017年1月25日22时",
     "date": 2017012522,
     "value": 2017012522
    },
    {
     "name": "2017年1月26日22时",
     "date": 2017012622,
     "value": 2017012622
    },
    {
     "name": "2017年1月27日22时",
     "date": 2017012722,
     "value": 2017012722
    },
    {
     "name": "2017年1月28日22时",
     "date": 2017012822,
     "value": 2017012822
    },
    {
     "name": "2017年1月29日22时",
     "date": 2017012922,
     "value": 2017012922
    },
    {
     "name": "2017年1月30日22时",
     "date": 2017013022,
     "value": 2017013022
    },
    {
     "name": "2017年1月31日22时",
     "date": 2017013122,
     "value": 2017013122
    },
    {
     "name": "2017年2月1日22时",
     "date": 2017020122,
     "value": 2017020122
    },
    {
     "name": "2017年2月2日22时",
     "date": 2017020222,
     "value": 2017020222
    }
    ]
    ```
    
    **字段**
    
    **说明**
    
    name
    
    时间轴的轴点显示的内容。
    
    date
    
    作为回调ID选项使用。
    
    value
    
    对应的时间。
    
    数据响应成功后，组件将在画布上展示对应的数据样式。
    
5.  退出**设置数据源**页面，在**时间轴**组件的**配置**面板中，单击**事件节点**，设置**数据格式**为**%Y%m%d%H**。
    
    ![配置数据格式](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9431839061/p9291.png)
    
6.  单击**交互**，设置回调ID的值为_data_。
    
    ![配置回调ID值](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9431839061/p9292.png)
    

## 添加地图标题数据

1.  在画布编辑器页面，单击选中**标题**组件。
2.  在右侧的**数据**面板中，单击**配置数据源**。
3.  在**设置数据源**页面，选择**数据源类型**为**数据库**。
    
    ![配置数据源](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9431839061/p9293.png)
    
4.  在**选择已有数据源**列表中，选择一个数据库。
    
    **说明** 如果没有可选的数据库，您可以单击**新建**，按照系统提示，新建一个数据库。详情请参见[配置数据源](https://help.aliyun.com/zh/datav/data-sources-overview#concept-ldr-4gp-p2b)。
    
5.  在**SQL**编辑区域，输入以下SQL脚本。
    
    ```
    select to_char(to_timestamp(:date,'YYYYMMDDHH24'),'YYYY年mm月DD日HH24时')||'空气质量' as value;
    ```
    
    `:date`：在实际浏览时会传入回调ID对应的值。
    
6.  单击**预览数据源返回结果**，查看数据返回结果。
7.  单击**数据响应结果**右侧的**刷新**图标，查看数据响应结果。
    
    数据响应成功后，组件将在画布上展示对应的数据样式。