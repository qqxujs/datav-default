# 线热力层（v2.x版本） %{#153637}% 

线热力层是基础平面地图的子组件，支持独立的样式、数据和交互配置，能够以热力线的形式表现地理位置上的线路信息，适用于地图上线路图的大屏展示，例如展示地铁线路图。本文介绍线热力层各配置项的含义。

**重要** 当前为v2.x版本的线热力层子组件指导文档，如需查看该子组件v1.x版本的文档内容详情，请参见[线热力层（v1.x版本）](/zh/datav/datav-6-0/user-guide/line-density-map-layer#concept-qcc-kf5-q2b)。

单击子组件管理下方的线热力层，进入配置面板配置线热力层的样式和数据。 

**说明** 如果子组件管理中没有线热力层，说明您还未添加线热力层子组件，请参见[地图容器（v2.x版本）](/zh/datav/datav-6-0/user-guide/map-container#concept-2400968)进行添加。

## 配置

* 搜索配置：单击配置面板右上角的搜索配置，可在搜索配置面板中输入您需要搜索的配置项名称，快速定位到该配置项，系统支持模糊匹配。详情请参见[搜索资产配置](/zh/datav/datav-6-0/user-guide/search-for-configurations#task-2376842)。
* 可见级别：设置线热力层的可见级别值，在设定的级别范围内线热力层可见，级别之外不可见。
* 线样式：设置线条配置类型、线颜色、线粗细和线类型等参数。  

|    参数    |    说明    |
|    ----    |    ----    |
|    配置类型    |    配置类型包括默认配置和数据映射。    |
|    线颜色    |    当选择配置类型为默认配置时，热力线颜色默认设置为一种颜色。当选择配置类型为数据映射时，数据value值最大、最小、为空时对应的热力线的颜色，请参见[颜色选择器说明](/zh/datav/datav-6-0/user-guide/configure-item-description#section-kdw-vj4-t2b)进行修改。处于最大值和最小值之间的线，根据value值映射成最大值到最小值之间的渐变颜色。 图 1\. 线热力层颜色配置项v2.x![线热力层颜色配置项v2.x](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/7958068951/p86710.png)图 2\. 线热力层数据源v2.x![线热力层数据源v2.x](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/7958068951/p86711.png)**重要** 如果数据中设置了color字段，则线的颜色以color字段为准。    |
|    线粗细    |    热力线的粗细。    |
|    线类型    |    热力线的类型。    |
* 系列配置：单击右侧的![加号图标](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/0201929951/p89097.jpg)或![垃圾桶图标](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/3208049161/p89098.jpg)图标，增加或删除一个系列。 单击![横排列图标](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/0201929951/p95437.jpg)或![竖排列图标](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/0201929951/p94077.jpg)图标配置多个数据系列的排列样式。  

|    参数    |    说明    |
|    ----    |    ----    |
|    类型过滤值    |    与数据源中的type字段对应，配置您所设置的type值对应散点热力线的样式。    |
|    配置类型/线颜色/线粗细    |    设置每一个系列的配置类型、线颜色和线粗细，具体请参见[配置](#section-nu3-hu9-v5a)下的线样式。    |
* 弹框：在预览或发布页面，单击热力线，显示线的详细信息弹框样式。单击弹框左侧的![眼睛图标](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/8648413261/p89095.jpg)图标，可控制弹框的显隐。  

**说明** 开启弹窗功能需要先设置info字段。

  * info字段：打开开关，开启info字段，设置info字段作为弹窗内容，该字段支持配置html标签；如果关闭info字段开关，则兼容name和value字段内容作为弹窗内容。
  * 事件类型：选择通过点击或鼠标移入事件作为弹框显示的类型。
  * 配置选项：弹框样式的配置项内容，可选择父容器默认或自定义配置。  
    * 父容器默认：系统自带的默认样式。
    * 自定义配置：自定义配置弹框的文本样式、行高比例和圆角半径等参数。  

|    参数    |    说明    |
|    ----    |    ----    |
|    文本样式    |    设置弹框内文本的字体、文字粗细、字号、颜色和阴影色，请参见[颜色选择器说明](/zh/datav/datav-6-0/user-guide/configure-item-description#section-kdw-vj4-t2b)进行颜色修改。    |
|    行高比例    |    设置弹框格式的行高比例值。    |
|    圆角半径    |    设置弹框的圆角半径值，数值越大圆角越圆。    |
|    外边距    |    设置弹框内文本与弹框四边的距离。    |
|    背景色    |    设置弹框的背景色。    |
|    关闭按钮    |    设置关闭弹框按钮的颜色、大小、按钮离顶部的距离和离右侧的距离。    |
* 交互配置

|    参数    |    说明    |
|    ----    |    ----    |
|    悬停样式    |    单击悬停样式左侧![眼睛图标](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/8648413261/p89095.jpg)图标，可控制悬停交互功能的开启或关闭。开启后可设置鼠标悬停时的热力线的颜色、粗细和类型，仅在预览或发布时才能看到效果。    |
|    点击聚焦    |    单击左侧![眼睛图标](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/8648413261/p89095.jpg)图标，可控制点击聚焦交互功能的开启或关闭。开启后，单击热力线，会根据热力线的位置进行一定范围比例的聚焦，仅在预览或发布时才能看到效果。    |

## 数据

该组件需要配置两个数据源，地理边界geojson数据接口和热力值数据接口。![线热力层地理边界geojson数据接口](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9901884261/p81590.png)
* 地理边界geojson数据接口：geojson类型的数据，要求类型为 LineString。如果需要跟映射数据对应，必须保证有唯一的 link\_id 或者 id 字段。关于geojson的标准可以参见 [geojson.org](http://geojson.org/geojson-spec.html)。  

**说明** properties字段对应配置面板中的弹窗信息，您可以自定义该字段值进行配置。
* 热力值数据接口![线热力层热力值数据接口](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9901884261/p81592.png)  
上图中的示例JSON代码如下。  
```  
[  
  {  
    "link_id": 1,  
    "value": 1,  
    "info": "名称：1</br>数值：1"  
  },  
  {  
    "link_id": 2,  
    "type": "type1",  
    "value": 20  
  },  
  {  
    "link_id": 3,  
    "type": "type1",  
    "value": 3  
  },  
  {  
    "link_id": 4,  
    "type": "type1",  
    "value": 4  
  },  
  {  
    "link_id": 5,  
    "type": "type2",  
    "value": 5  
  },  
  {  
    "link_id": 6,  
    "type": "type2",  
    "value": 5  
  },  
  {  
    "link_id": 7,  
    "value": 7  
  },  
  {  
    "link_id": 8,  
    "value": 8  
  }  
]  
```  
__表 1\. 字段说明__
|    字段    |    说明    |
|    ----    |    ----    |
|    link\_id    |    线关联ID，通过该字段，与矢量线数据进行对应。    |
|    type    |    线类型，与配置面板中系列类型过滤值对应。    |
|    value    |    线的权重值，是配置面板中设置最大值、最小值、空值颜色的依据。    |
|    info    |    （可选）弹窗内容，如果为空，则弹窗信息显示为对应的矢量线数据中的properties字段的内容。如果不为空，弹窗信息显示为info字段的内容。    |
|    color    |    （可选）线热力层支持数据优先的渲染，如果您配置了color（线颜色）、weight（线宽）、dashArray（虚线）等字段，那么会优先使用这些属性来对关联的线进行渲染。    |

__表 2\. 配置项说明__
|    配置项    |    说明    |
|    ----    |    ----    |
|    受控模式    |    打开开关，资产初始化状态下不请求数据，仅通过回调ID或蓝图编辑器配置的方法发起请求数据；关闭开关，可以使用自动更新请求数据。开关默认为关闭状态。    |
|    自动更新请求    |    选中后可以设置动态轮询，还可以手动输入轮询的时间频次。取消选中后则不会自动更新，需要手动刷新页面，或通过蓝图编辑器和回调ID事件来触发请求更新数据。    |
|    数据源    |    单击配置数据源，可在设置数据源面板中修改数据源类型和数据查询代码、预览数据源返回结果以及查看数据响应结果，详情请参见[配置资产数据](/zh/datav/datav-6-0/user-guide/configure-widget-data#task-2376875)。    |
|    数据过滤器    |    数据过滤器提供数据结构转换、筛选和一些简单的计算功能。单击添加过滤器，可在设置数据源面板配置数据过滤器脚本，详情请参见[过滤器使用说明](/zh/datav/datav-6-0/user-guide/use-the-data-filter#task-1322674)。    |
|    数据响应结果    |    展示数据请求的响应结果。当数据源发生改变时，可单击右侧的![刷新图标 ](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/0376703061/p89093.png)图标，实时查看数据响应结果。    |

## 交互

选中启用，开启组件交互功能。线热力层子组件拥有交互配置，可单击热力线或鼠标移入到某条热力线时抛出回调值，默认抛出数据中的link\_id字段。具体配置请参见[组件回调ID配置](/zh/datav/datav-6-0/user-guide/configure-callback-ids-for-ticker-boards#concept-m2n-fy3-52b)。![线热力层交互配置](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/8958068951/p81594.jpg)

## 蓝图编辑器交互配置

1. 在画布编辑器页面，单击基础平面地图子组件管理列表中线热力层右侧的![导出到蓝图编辑器](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/2434449951/p89089.jpg)图标。
2. 单击页面左上角的![蓝图图标](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/2434449951/p89087.jpg)图标。
3. 在蓝图编辑器配置页面，单击导入节点栏内的线热力层组件，在画布中可以看到如下图所示的线热力层的蓝图编辑器配置参数。![线热力层蓝图编辑器参数v2.x](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/0011884261/p81596.jpg)
  * 事件

|    事件    |    说明    |
|    ----    |    ----    |
|    当地理边界geojson数据接口请求完成时    |    地理边界geojson数据接口请求返回并经过过滤器处理后抛出的事件，同时抛出处理后的JSON格式的数据。具体数据示例请参见画布编辑器中组件右侧配置面板数据页签的数据响应结果区域。    |
|    当热力值数据接口请求完成时    |    热力值数据接口请求返回并经过过滤器处理后抛出的事件，同时抛出处理后的JSON格式的数据。具体数据示例请参见画布编辑器中组件右侧配置面板数据页签的数据响应结果区域。    |
|    当地理边界geojson数据接口请求失败时    |    地理边界geojson数据接口请求失败时（请求失败的情况可能是：网络问题或接口报错等）返回并经过过滤器处理后抛出的事件，同时抛出处理后的JSON格式的数据。具体数据示例请参见画布编辑器中组件右侧配置面板数据页签的数据响应结果区域。    |
|    当热力值数据接口请求失败时    |    热力值数据接口请求失败时（请求失败的情况可能是：网络问题或接口报错等）返回并经过过滤器处理后抛出的事件，同时抛出处理后的JSON格式的数据。具体数据示例请参见画布编辑器中组件右侧配置面板数据页签的数据响应结果区域。    |
|    当点击线时    |    当单击某条线时触发事件，抛出link\_id字段数据。    |
|    当鼠标移入时    |    当鼠标移入某条线时触发事件，抛出link\_id字段数据。    |
  * 动作

|    动作    |    说明    |
|    ----    |    ----    |
|    请求地理边界geojson数据接口    |    重新请求服务端数据，上游数据处理节点或图层节点抛出的数据将作为参数。例如线热力层配置了API数据源为https://api.test，传到请求地理边界geojson数据动作的数据为{ id: '1'}，则最终请求接口为https://api.test?id=1。    |
|    请求热力值数据接口    |    重新请求服务端数据，上游数据处理节点或图层节点抛出的数据将作为参数。例如线热力层配置了API数据源为https://api.test，传到请求热力值数据动作的数据为{ id: '1'}，则最终请求接口为https://api.test?id=1。    |
|    导入地理边界geojson数据接口    |    按组件绘制格式处理数据后，导入组件，重新绘制。不需要重新请求服务端数据。具体数据示例请参见画布编辑器中组件右侧配置面板数据页签的数据响应结果区域。    |
|    导入热力值数据接口    |    按组件绘制格式处理数据后，导入组件，重新绘制。不需要重新请求服务端数据。具体数据示例请参见画布编辑器中组件右侧配置面板数据页签的数据响应结果区域。    |
|    显示    |    显示组件，不需要参数。    |
|    隐藏    |    隐藏组件，不需要参数。    |