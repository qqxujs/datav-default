# BI分析器交互使用说明 %{#312363}% 

在DataV数据集和组件分析模式的基础上，分析器交互给组件附加了下钻、联动筛选等交互式动态数据查询的能力，将基于您交互反馈的数据模型变更纳入可视化应用的交互，形成完整的可视化分析循环。所有交互可在预览模式和发布结果中进行。本文介绍分析器具体交互功能的使用说明。

配置分析器交互需先创建一个分析模式的组件，具体创建支持分析模式的组件且进入分析模式请参见[进入组件分析模式](/zh/datav/datav-6-0/user-guide/enable-the-widget-analysis-mode#concept-2115149)。分析组件创建后会被分析器包裹，在层级树上显示为如下样式。![分析器树状结构](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/8558781361/p326662.jpg)

**说明** 
* 使用分析器交互前，请先关闭扫光动画。
* 所有分析交互可在预览模式和发布结果中进行。

## 分析器配置面板

在画布编辑器中，您可以直接单击图层栏内的分析器或者在画布中单击选中某个BI分析组件后，单击画布中该组件右上角的![分析器入口](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9558781361/p327613.jpg)图标，即可切换选中该组件对应的分析器，选中分析器后，在画布编辑器右侧面板中切换到的分析器**配置**面板内可配置分析器的各种样式参数。

* **面包屑**：分析器内展示下钻交互触发效果及路径的区域样式。![面包屑样式面板](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9558781361/p327633.png)

|    **参数**    |    **说明**    |
|    ----    |    ----    |
|    **显示**    |    打开开关，显示面包屑样式；关闭开关，不显示面包屑样式。    |
|    **布局**    |    设置面包屑样式在对应分析组件的四周布局的样式，可选**顶部居左**、**顶部居中** **顶部居右**、**底部居左**、**底部居中**和**底部居右**。    |
|    **位置**    |    设置面包屑位于对应分析组件的内外部位置样式，可选**内侧**或**外侧**。    |
|    **文本样式**    |    设置面包屑内文本的样式，包括文本字体、文字粗细值、 文本字号大小和文本的颜色。    |
* **菜单栏**：分析器内展示数据刷新和复制traceId交互功能的菜单栏样式。![菜单栏样式面板](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9558781361/p327691.png)

|    **参数**    |    **说明**    |
|    ----    |    ----    |
|    **显示**    |    打开开关，显示菜单栏样式；关闭开关，不显示菜单栏样式。    |
|    **布局**    |    设置菜单栏样式在对应分析组件的四周布局的样式，可选**顶部居左**、**顶部居中** **顶部居右**、**底部居左**、**底部居中**和**底部居右**。    |
|    **位置**    |    设置菜单栏位于对应分析组件的内外部位置样式，可选**内侧**或**外侧**。    |
|    **尺寸**    |    设置菜单栏的尺寸大小值，默认值为48。    |
* **信息标签**：分析器内展示对应分析组件名称的信息标签样式以及对该组件数据产生影响的联动关系。![信息标签样式面板](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9558781361/p327693.png)

|    **参数**    |    **说明**    |
|    ----    |    ----    |
|    **显示**    |    打开开关，显示信息标签样式；关闭开关，不显示信息标签样式。    |
|    **布局**    |    设置信息标签样式在对应分析组件的四周布局的样式，可选**顶部居左**、**顶部居中** **顶部居右**、**底部居左**、**底部居中**和**底部居右**。    |
|    **位置**    |    设置信息标签位于对应分析组件的内外部位置样式，可选**内侧**或**外侧**。    |
|    **尺寸**    |    设置信息标签文本的样式，包括文本字体、文字粗细值、 文本字号大小和文本的颜色。    |
* **错误信息**：设置分析器错误信息报错时的文本样式，包括设置错误信息文本的字体、文字粗细值、 文本字号大小和文本的颜色。![错误信息文本显示样式](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/3266491361/p327904.png)

## 分析器数据面板

分析器不需要配置数据。

## 分析器交互面板配置

单击画布右侧分析器配置面板上的**交互**面板内可进行分析器交互相关的配置。![分析器交互面板](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9558781361/p327369.jpg)

* **分析探索**

|    **参数**    |    **说明**    |
|    ----    |    ----    |
|    **下钻优先**    |    当选中下钻优先时，在预览和发布效果时，单击组件优先触发下钻效果，直到无法继续下钻则触发选中效果。    |
|    **选中优先**    |    当选中优先时，在预览和发布效果时，单击组件优先触发选中联动效果。    |
* **联动**：当在预览和发布效果时进行下钻或选中时，根据下钻范围或选中项筛选可联动的其他组件。具体支持如下几个联动配置功能。

**说明**  
可联动的组件仅限使用相同数据集的组件。

|    **功能**    |    **操作**    |
|    ----    |    ----    |
|    查看支持交互    |    在同一个分析器内包裹的不同的BI分组件可能不支持其中的一种或多种交互功能，您可以在联动面板下方每个BI组件右侧的图标处查看支持的交互功能。![支持一种或多种交互样式](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9558781361/p327375.png)    |
|    选择联动BI分析组件    |    您可以勾选一个或多个同一个分析器内被包裹的BI分析组件，选中后可配置联动效果。    |
|    选择联动效果    |    为每一个勾选联动的组件，配置对应的联动效果，包括**触发其他组件联动**或**接受其他组件联动**两种效果。![联动样式面板](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9558781361/p327368.jpg)**说明** 互相联动的组件之间必须使用同一个数据集。    |
|    跳转组件交互    |    单击支持联动效果的BI分析组件右侧的![箭头图标](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9558781361/p327371.jpg)图标，即可跳转至该分析组件的交互面板，您可以自定义配置分析组件的交互功能。    |

## 分析器基本交互功能说明

分析器作为所有分析交互的基本单元，即如果多个分析组件位于同一个分析器内，该多个组件会共享分析交互控件和部分交互配置功能。

**说明** 

多个分析组件位于同一个分析器内的情况，只会在画布编辑器的**基础平面地图 3.0**地图中同时添加了多个分析模式子组件的时候出现。

分析器组件的分析交互配置可在选中分析器后在右侧面板的**交互**面板内找到，其中可以配置分析器内包裹的BI分析组件的下钻及联动筛选功能。

在可视化应用预览或发布结果时，鼠标移动悬停到分析组件上方，您可以实现分析器如下几个基本实用交互功能。

|    **功能**    |    **说明**    |
|    ----    |    ----    |
|    刷新数据    |    单击分析组件菜单栏（默认展示在右上角）内的![刷新数据](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9558781361/p327276.jpg)图标，刷新分析器及对应分析组件获取的数据。    |
|    复制traceId    |    单击分析组件菜单栏（默认展示在右上角）内的![选项图标](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9558781361/p327277.jpg)图标，选择**复制traceId**选项，当分析器出现问题时，可通过将复制的ID上报给DataV技术人员寻求帮助，并解决报错的问题。    |
|    更改触发效果    |    单击分析组件面包屑（默认展示在左上角）内的![下钻按键](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/8837681361/p327486.jpg)或![触发图标](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9558781361/p327515.jpg)图标，在下拉框内可以自定义切换下钻优先或选中优先的效果选项。![切换下钻效果](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/0658781361/p327392.png)**说明** 面包屑内切换效果选项具有临时性，当预览或发布的可视化应用网页链接被刷新后，即会恢复原本分析器交互面板内设置的配置效果。    |
|    展示下钻路径    |    当分析组件的数据面板内配置了下钻字段后，可在预览模式和发布结果中单击实现字段下钻交互功能。下钻后，分析组件面包屑处会展示当前下钻的路径（默认展示在左上角），单击面包屑菜单可以返回指定的下钻层级。![下钻路径](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/0658781361/p327527.png)    |
|    联动筛选    |    分析组件之间可进行互相联动，可通过单击选项进行筛选。支持两个分析组件进行互相联动需要满足两个条件：开启了相关联动配置选项，具体联动配置可以参见[分析器配置面板](#section-w2b-iz4-wr9)中的**联动**部分。组件都使用相同的数据集。在开启联动后展示效果时，根据下钻选中项，联动组件会筛选出对应选项的数据内容进行展示。如下图选中地区中的华东进行下钻，则使用同样数据集的联动组件会对地区=华东，实现过滤展示的效果。**说明** 分析组件会与同一屏幕上其它组件进行联动，联动是双向的，可以在联动配置中选择关闭部分联动。图 1\. 组件联动之前![组件联动之前](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/0658781361/p327556.png)图 2\. 组件联动效果展示![组件联动效果展示](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/0658781361/p327558.png)    |

## 分析组件交互样式相关配置

当分析器包裹的联动组件之间设置了**选中优先**触发交互时，您还可以在每个分析组件的样式配置面板中的**交互** **\>选中态**中配置选中状态时组件的触发方式和选中方式等参数配置项。![交互选中态配置样式](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/0658781361/p327608.png)

**说明** 

不同的组件的配置项参数上略有区别，具体请参见[BI分析组件](/zh/datav/datav-6-0/user-guide/column-chart-for-datav-6#concept-2090347)。

## 分析组件配置面板快捷跳转至分析器配置面板

当您在配置一个BI分析组件时，可通过两种方式快捷跳转至对应的分析器配置面板。方法如下：

* 单击BI分析组件交互面板底部的**配置分析器交互**按键，即可快捷跳转其分析器的交互面板。![快捷跳转分析器交互](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/0658781361/p327396.png)
* 单击BI分析组件样式配置面板底部的**配置分析器样式**按键，即可快捷跳转至分析器的样式配置面板。![跳转分析器配置面板](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/0658781361/p327662.png)

## 分析器蓝图编辑器交互配置

虽然BI分析组件无法导出到蓝图编辑器配置关联交互功能，但是分析组件对应的分析器却可以导出到蓝图编辑器，并配置蓝图相关交互事件及动作。

1. 在画布编辑器页面，右键单击图层栏内BI分析组件对应的分析器，选择**导出到蓝图编辑器**。
2. 单击页面左上角的![蓝图图标](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/7416559951/p101929.png)图标。
3. 在蓝图编辑器配置页面，单击导入节点栏内的**分析器|xxx**节点，在画布中可以看到如下图所示的分析器的蓝图编辑器配置参数。![分析器蓝图参数](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/0658781361/p327671.png)

  * **事件**

|    **事件**    |    **说明**    |
|    ----    |    ----    |
|    **当下钻或选中变动时**    |    当下钻或选中变动事件触发时，抛出object类型的数据项，自动化控制数据分析的展示，需要包含如下字段：{   "id": "",                    //进行下钻或选中的分析器id   "drillStack": \[              //记录下钻路径     {       "comId": "",             //发起下钻的组件id       "datasetId": 96,         //下钻所使用的数据集id       "fields": \[              //下钻的详细信息，按列存储         {           "chartKey": "x",           "code": "L",           "alias": "地区",           "dateTimeGranularity": "",           "geoFormat": "",           "values": \[          //数据库中存储的实际值             "华东"           \],           "displayValues": ""  //有地理转换时与数据库实际值存在差异         }       \]     }   \],   "brushes": \[                //记录所有组件/子组件选中内容     {       "comId": "",            //发起选中的组件id       "selections": \[         //选中的详细信息，按列存储         {           "chartKey": "x",           "code": "L",           "alias": "地区",           "dateTimeGranularity": "",           "geoFormat": "",           "values": \[             "华东"           \],           "displayValues": ""         }       \]     }   \] }    |
  * **动作**

|    **动作**    |    **说明**    |
|    ----    |    ----    |
|    **下钻**    |    当进行下钻动作时，传入数据 object类型，需包含如下字段：{   "id": "",      //进行下钻的组件id,当分析器包裹了复数子组件时必须指定   "items": \[     //需要选中的数据项，单个选中：{x:'上海',y:100}；批量选中：\[{x:'上海',y:100},{x:'深圳',y:75}\]     {       "any": ""   //任意     }   \] }    |
|    **回退下钻**    |    当进行回退下钻动作时，传入数据 object类型，需包含如下字段：{   "depth": 0,          //回退到的层级，0为清空下钻，-1为回退一层   "forceClear": false  //默认值false,即使没有产生实际的回退也强制清空选中 }    |
|    **选中**    |    当进行选中动作时，传入数据 object类型，需包含如下字段：{   "id": "",       //进行下钻的组件id,当分析器包裹了复数子组件时必须指定   "items": \[      //需要选中的数据项，单个选中：{x:'上海',y:100}；批量选中：\[{x:'上海',y:100},{x:'深圳',y:75}\]     {       "any": ""   //任意     }   \] }    |