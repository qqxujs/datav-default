<!DOCTYPE html> 

过滤器是用于动态筛选和控制可视化数据的核心组件，本文将系统介绍其配置、管理及多场景应用的操作方法。

## **背景信息**

### **原理介绍**

过滤器是数据可视化中实现动态数据交互的重要功能，它通过用户定义的条件规则（如数值区间、文本匹配、逻辑组合等）对原始数据进行实时筛选，并将结果更新至所有关联的可视化组件。

### **使用场景**

过滤器在数据可视化中应用广泛，主要用于动态控制数据的显示内容，典型场景包括：

* 在销售报表中，只显示某个地区的业绩数据。
* 在实时监控大屏中，筛选出异常值（比如超过阈值的温度数据）。
* 结合下拉菜单或滑块，让用户自己选择想查看的数据范围。

## **准备工作**

### **前提条件**

已经创建[数据看板项目](https://help.aliyun.com/zh/datav/datav-7-0/user-guide/use-a-template-to-create-a-project-on-pc)。

### **进入画布编辑器**

进行过滤器配置等相关操作前，请先依照以下步骤进入[画布编辑器](https://help.aliyun.com/zh/datav/datav-7-0/user-guide/overview-of-canvas-editor-on-pcs)：

1. 登录[DataV控制台](https://datav.aliyun.com/v/console/)。
2. 在**工作台**页面，将鼠标悬停至目标项目上，单击**编辑**进入画布编辑器页面。

## **新建过滤器**

您可以通过以下两种方法新建过滤器。

* **面板中新建过滤器**

  1. 在画布编辑器页面的左侧导航栏中，单击**过滤器**，进入过滤器页面。
  2. 在过滤器面板中，单击**新建过滤器**。
  3. 在过滤器配置区域，输入过滤器的名称和自定义的过滤代码，单击**保存**。
  4. （可选）编辑过滤器时，可以单击**关联全局变量**，将已创建的全局变量关联到当前过滤器中，关联后可以直接在代码中使用该变量。![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6259954471/p938204.png)  
  创建成功的过滤器会排列显示在过滤器列表中。  

**说明**  
  创建的过滤器可被当前数据看板内的所有组件调用，被调用后，会显示组件和过滤器的关联关系。
* **组件中新建过滤器**。  
组件支持两种过滤器创建方式：手动配置和[智能生成](#d9b153fe76db3)。

  1. 在当前数据看板中添加一个组件（示例中使用柱状图），单击右侧配置面板中的**数据源**。
  2. 在**数据源**配置面板中，打开过滤器，单击**新建**。![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6259954471/p938196.png)
  3. 在过滤器配置区域，输入过滤器的名称和自定义的过滤代码，单击**保存**。
  4. 创建成功的过滤器会排列显示在过滤器列表中，并显示过滤器和组件之间的依赖关系。

## **管理过滤器**

### **过滤器面板**

在**过滤器**面板中，您可以统一管理看板内所有过滤器。这些过滤器支持被任意组件添加使用，每个过滤器右侧会显示其被调用的数量。

![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/3179649761/p607737.png)

**重要** 

在过滤器面板中修改某个过滤器的配置时，会使所有依赖这个过滤器的组件不可用，请确认影响范围后再保存变更。

### **基础操作**

* **重命名过滤器**：鼠标悬停至目标过滤器上，单击![{36390127-9760-4AF2-80B1-74722D42DAE2}](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6259954471/p938221.png)图标，输入过滤器名称。
* **删除过滤器：**鼠标悬停至目标过滤器上，单击![{6326EB79-7C4F-4D4E-B88A-C15A44238390}](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6259954471/p938222.png)图标删除过滤器。

**重要**  
删除过滤器操作可能会导致相关组件不可用，请确认后操作。
* **添加过滤器：**在组件的**数据源**配置面板中，打开过滤器开关，从下拉菜单中选择目标过滤器。  
![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6259954471/p938225.png)
* **清空未使用过滤器：**在组件中添加多个过滤器后，您可以在过滤器面板中单击**清空未使用过滤器**一键清除所有未使用的过滤器。

**重要**  
过滤器被清除后无法恢复，请谨慎操作。

### **排序过滤器**

在组件中添加了多个过滤器后，可以通过上下拖动过滤器进行排序。![2025-04-07_15-10-20](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6259954471/p938238.gif)

**过滤顺序：**在组件数据源中添加多个过滤器后，数据将按照从上到下的顺序依次经过各个过滤器进行处理：第一个过滤器的输入是数据源直接返回的原始结果，第二个过滤器的输入是第一个过滤器处理后的输出数据，后续过滤器以此类推，每个过滤器都基于前一个过滤器的输出结果进行进一步处理，最终输出经过所有过滤器级联处理后的数据结果。

**重要** 
* 如果中间有过滤器返回值为空，那么该过滤器会被忽略，但过滤不会终止，且系统会在多个过滤器配置页面中进行提示。
* 如果某个过滤器执行报错，那么过滤会终止，并采用上一次执行正确的结果。

### **调试过滤器**

在**数据源**页面中，可以编辑过滤代码进行调试，左侧弹窗实时展示返回结果。

**说明** 

过滤器调试功能可确保过滤代码的正确性，但不适用于数据量过大的情况。

![image.png](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6259954471/p938243.png)

## **使用过滤器**

以下示例以**柱状图**组件为例，分别演示了过滤器在画布编辑器和蓝图编辑器中的具体应用方法。

### **画布中使用**

1. 在画布编辑器中添加一个柱状图组件。
2. 选中当前组件，在右侧配置面板中单击**数据源**页签。
3. 勾选过滤器复选框，单击**新建**，新建过滤器。![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6989882761/p543385.png)
4. 修改过滤器名称为`柱状图过滤器`，并使用以下代码替换初始过滤代码。  
```  
return data.splice(0,3)//过滤出前三项数据  
```
5. 单击过滤器下方的**测试**，查看输出结果。如下图所示，为过滤器过滤后的效果。![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6989882761/p543419.png)
6. 测试成功后，单击**保存**完成过滤器代码编辑，即可在画布中查看过滤后的可视化图表。  
![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6989882761/p543423.png)

### **蓝图中使用**

1. 在画布编辑器中添加两个柱状图组件。
2. 单击页面左上角的![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6679882761/p543426.png)图标，切换到**蓝图**页面。
3. 在左侧**图层节点**页签中，将两个柱状图节点拖拽添加到蓝图主画布中。
4. 单击左侧**逻辑节点**页签，添加一个**串行数据处理**节点。
5. 依次将柱状图和串行数据处理节点连线，如图所示。![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/8369649761/p607741.png)
6. 选中串行数据处理节点，在右侧**节点配** **置**面板中的**处理方法**模块单击**新建**，新增一个过滤器。
7. 修改过滤器名称为**柱状图串行处理**，并使用以下代码替换初始过滤代码。![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/7679882761/p543445.png)  
```  
return data.splice(0,3)//过滤出前三项数据  
```
8. 单击过滤器下方的**保存**完成编辑，然后单击蓝图页面右上角的**预览**进入预览页面。组件加载完成后即可查看筛选后的图表结果。  
![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/7679882761/p543449.png)

## **代码智能推荐**

过滤器的智能代码推荐功能采用AI辅助技术，用户通过自然语言描述数据处理需求，系统即可自动生成相应的数据过滤代码，并支持在线编辑与调优。

### **操作示例**

1. 在当前数据看板中添加一个组件（例如：柱状图）。
2. 选中已添加的组件，单击右侧配置面板中的**数据源**。
3. **数据源**配置面板中，打开过滤器，单击**智能推荐**。
4. 在输入框中输入数据处理条件（示例：`当y大于10时设置为10，为x添加'类型：'前缀。`），按`Enter`键确认。![{4656FC40-D626-4BA6-B9C6-F3A51AA5DC62}](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6259954471/p938076.png)
5. 生成的**数据处理脚本**支持二次编辑，并支持在**数据响应结果**区域实时查看处理后的数据详情。确认无误后单击**应用**，画布编辑器中将展示过滤器筛选后的图表结果。![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6259954471/p938682.png)
6. 可选，若不需要使用当前处理方法，单击**撤销应用**即可。

## **常见问题**

* **数据源报错**：在组件数据面板添加过滤器后，若切换至其他类型的数据源，系统将在错误信息区域显示以下两条接口异常提示。![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6259954471/p938252.png)

**重要**  
当数据源异常时，即使接口返回了数据内容，数据面板中的过滤器仍会保持禁用状态（置灰显示）。由于数据流在源头已存在异常，后续的过滤处理将不再具有实际意义。
* **过滤器报错**：当过滤器执行数据过滤时，若代码运行出错（如"待返回字段未定义"等异常），系统将在界面显示错误提示。![image](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/6259954471/p938253.png)

## **相关操作**

过滤器中引用全局变量的方法**getLocalValue**和**getCallbackValue**请参见[过滤器引用](https://help.aliyun.com/zh/datav/datav-7-0/user-guide/use-global-variables#6215b1f0d7p0f)。