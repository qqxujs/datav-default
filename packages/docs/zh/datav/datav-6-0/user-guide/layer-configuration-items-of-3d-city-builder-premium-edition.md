  三维城市构建器图层数据配置方法-DataV数据可视化-阿里云

本文对三维城市构建器项目内的图层配置项进行了概括性说明。

在场景编辑器中，单击左侧图层面板内的某一个图层，场景编辑器右侧会出现图层的配置项面板。包括配置和数据两个标签页。![配置项面板](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/7516197461/p419739.png)

-   在配置页签中，您可以配置场景内图层的样式，每个图层的配置项内容都是不同的，具体配置方法请参见本章节中各组件的说明文档。
-   在数据页签中，不同的图层在数据面板上的配置内容不一样，图层可分为基底组件、数据图元组件、栅格瓦片、地形瓦片、三维瓦片和其他六类。
    -   基底组件：在基底组件数据面板中，您可以配置如下两个功能。
        
        图 1. 基底道路图层示例数据面板样式
        
        ![基底数据道路图层示例数据面板样式](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/2621411561/p266288.png)
        
        -   重新选择数据：单击数据面板内的重新选择数据，打开选择范围对话框，即可重新选择仅针对当前图层对应的数据范围，详情请参见[创建三维城市场景项目](https://help.aliyun.com/zh/datav/datav-6-0/user-guide/create-3d-city-projects#concept-1986564 "三维城市构建器项目，支持通过使用官方基底数据和空间构建数据两种方式添加多个城市基底子组件和数据映射子组件。本文介绍两种创建三维城市构建器场景的方法。")中的官方基底数据中选择场景范围区域步骤或 空间构建数据中选择空间数据项目步骤。
        -   刷新数据：单击数据面板内的刷新数据，即可刷新当前图层的配置数据并重新加载最新数据内容到场景编辑器中。
            
            **说明** 如使用空间构建基底数据，当数据变更时都需要单击刷新数据按键 ，进行页面数据的刷新，使得场景内图层的数据保持最新状态。
            
    -   数据图元组件、栅格瓦片、地形瓦片、三维瓦片和其他：在这五个类型图层数据面板中，数据配置和普通图表组件一致，可配置静态数据源、API数据源和空间构建数据源内容，还可将图层数据接口作为区块数据接口，在可视化应用中配置更丰富的数据源类型或实现与普通图表组件的数据交互，详情请参见[一键生成区块接口](#section-7sz-kpw-0b3)。
        
        图 2. 数据图元三维图标图层数据面板示例
        
        ![业务数据三维图标图层数据面板示例](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/2621411561/p266297.png)
        

## 配置空间构建数据源

如果您在创建三维城市项目时，使用了空间构建数据模式，并且项目内包含各种适用业务展示图层效果的空间数据内容。在场景编辑器内配置图层的数据面板时，您还可以使用空间构建数据源的内容。以区域柱状图对应数据为例。具体操作如下：

1.  在图层配置面板中选择数据页签，单击面板下方的数据源类型下拉框，选择空间构建数据源。
2.  在面板下方的数据项目下拉列表中，选择一个空间构建平台内已有的数据项目。![选择数据项目](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/8542019161/p264408.png)
3.  选择完数据项目后，在数据集下拉列表中，选择一个匹配的数据。![数据集面板](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/8542019161/p266156.png)
    
    **说明** 如果数据项目和数据集配置项内没有任何可供配置数据类型的内容，请您单击面板内前往空间构建平台管理数据处，进入空间构建平台配置数据。详情请参见[空间数据管理概览](https://help.aliyun.com/zh/datav/overview-of-spatial-data-management-for-datav-6#concept-2042937 "空间数据管理页面内提供了我的主页、我的项目、我的数据和空间档案四大功能模块，用户可以在这里创建项目，上传数据和添加模型等。本文为您介绍空间数据管理页面的结构与功能，帮助您快速使用空间构建平台。")。
    
    ![管理构建平台入口](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/7516197461/p419763.png)

## 一键生成区块接口

1.  选中数据图元组件、栅格瓦片、地形瓦片、三维瓦片和其他这五个类型的某个图层，在数据面板中单击一键生成区块接口按键，下图以三维图标图层为例。![确认生成区块接口](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/2621411561/p435040.jpg)
2.  在二次确认是否生成区块接口对话框中，单击右下角的确定，即可将当前图层内的默认数据接口内容快速生成到区块接口面板中。![生成区块接口](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/2621411561/p435043.png)
    
    **说明**
    
    -   将图层数据接口生成到区块接口后，可以实现在可视化应用内配置图层数据的功能。
    -   将图层数据接口生成区块接口后，当您在场景编辑器内修改该图层数据面板内的数据内容时，仅作为场景编辑页测试效果，发布三维城市项目并在可视化应用中使用时，以可视化应用中配置的数据内容为准。
    -   如您将某个图层一键生成区块接口后，想取消该图层的区块接口功能效果，您可以单击场景编辑器右上角的数据接口 > 区块接口设置，在面板中删除该图层的数据接口内容即可恢复。
    -   您可以根据业务需求选择合适的图层数据配置方式，当不需要在可视化中多次修改数据时，可以选择在场景编辑器中直接配置图层的数据内容；当在可视化应用中需要对三维城市项目图层做出更多类型数据源或者数据交互需求时，则建议您将后续需要修改数据的图层一键生成区块接口，再在可视化应用中配置数据。
    
3.  单击场景编辑器页面右上角的![预览](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/2621411561/p435088.jpg)图标，在预览页面中，您可以单击左侧的测试区块接口处，打开测试区块接口页签，您可以测试图层的数据、事件和动作接口功能，测试方法详情请参见[配置区块接口](https://help.aliyun.com/zh/datav/datav-6-0/user-guide/configure-block-interfaces-for-professional-edition#concept-2201777 "如果您需要与三维城市构建器项目外的其他可视化组件之间进行交互联动，则需要为项目配置数据接口、事件和动作设置。三维城市构建器项目场景编辑器中提供了区块接口设置的功能，可用于自定义设置项目的数据接口、事件和动作。本文介绍在项目中区块接口的设置及使用方法。")中的测试数据、事件和动作的功能。
    
    图 3. 测试区块接口入口
    
    ![测试区块接口入口](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/2621411561/p435091.jpg)
    
    图 4. 测试区块接口面板
    
    ![测试数据接口面板](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/2621411561/p435092.jpg)