<!DOCTYPE html> 

地形是三维城市构建器的基底图层，用于表示程序化生成的山体体形。地形支持独立的样式和数据配置，包括地形的阴影、环境贴图强度系数和混合贴图等样式配置。本文介绍地形配置项的含义。

在场景编辑器左侧图层列表中，单击地形图层，进入配置面板配置地形图层的样式和数据。 

**说明** 如果图层列表中没有地形，说明您还未添加地形图层，请参见[添加子组件](https://help.aliyun.com/zh/datav/datav-6-0/user-guide/layer-panel-management-of-professional-edition#section-1yb-xd4-pfe)进行添加。 

## 配置

![地形配置面板](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/3616197461/p417035.png)
* 地形：设置地形面板参数。  

| 参数 | 说明                                 |
| ---- | ---- |
| 阴影 | 设置地形的阴影样式，打开或关闭接收阴影开关，控制地形的投射阴影效果。 |
* 图形：设置图形面板参数。  

| 参数    | 说明                                                                                                                                    |
| ---- | ---- |
| 混合    | 设置地形混合类型的材质样式，包括调整混合类型在x轴和y轴方向的UV平铺值大小、混合参数和权重贴图样式。 **说明** 贴图仅支持使用PNG或者JPG格式的图片。                                                      |
| 混合材质A | 设置地形为混合A类型的材质样式，包括设置混合材质A的基础颜色、基础颜色贴图样式、粗糙度值、粗糙度贴图样式、金属度值、金属度贴图样式、法线贴图样式、环境遮蔽贴图强度值、环境遮蔽贴图样式、发光颜色和发光贴图样式。 **说明** 贴图仅支持使用PNG或者JPG格式的图片。 |
| 混合材质B | 设置地形为混合B类型的材质样式，包括设置混合材质B的基础颜色、基础颜色贴图样式、粗糙度值、粗糙度贴图样式、金属度值、金属度贴图样式、法线贴图样式、环境遮蔽贴图强度值、环境遮蔽贴图样式、发光颜色和发光贴图样式。 **说明** 贴图仅支持使用PNG或者JPG格式的图片。 |
| 混合材质C | 设置地形为混合C类型的材质样式，包括设置混合材质C的基础颜色、基础颜色贴图样式、粗糙度值、粗糙度贴图样式、金属度值、金属度贴图样式、法线贴图样式、环境遮蔽贴图强度值、环境遮蔽贴图样式、发光颜色和发光贴图样式。 **说明** 贴图仅支持使用PNG或者JPG格式的图片。 |
| 混合材质D | 设置地形为混合D类型的材质样式，包括设置混合材质D的基础颜色、基础颜色贴图样式、粗糙度值、粗糙度贴图样式、金属度值、金属度贴图样式、法线贴图样式、环境遮蔽贴图强度值、环境遮蔽贴图样式、发光颜色和发光贴图样式。 **说明** 贴图仅支持使用PNG或者JPG格式的图片。 |

## 数据

![地形面板](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/3616197461/p419711.png)

重新选择数据：在数据面板内可以单击下方重新选择数据，打开选择范围对话框，重新选择仅针对地形图层的数据范围，详情请参见[使用官方基底数据方式创建](https://help.aliyun.com/zh/datav/datav-6-0/user-guide/create-3d-city-projects#section-bsj-xjl-qx7)中的选择场景范围区域的操作步骤。 

## 蓝图编辑器交互配置

1. 在当前场景编辑器页面，单击左侧图层列表中地形右侧的![导出到蓝图编辑器](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/2434449951/p89089.jpg)图标。
2. 单击页面左上角的![蓝图图标](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/2434449951/p89087.jpg)图标。
3. 在蓝图编辑器配置页面，单击导入节点栏内的地形图层，在画布中可以看到如下图所示的地形的蓝图编辑器配置参数。![地形蓝图配置参数](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/3616197461/p419712.png)
  * 事件

| 事件         | 说明                                                                             |
| ---- | ---- |
| 当数据接口请求完成时 | 数据接口请求返回并经过过滤器处理后抛出的事件，同时抛出处理后的JSON格式的数据。具体数据示例请参见画布编辑器中组件右侧配置面板数据页签的数据响应结果区域。 |
| 渲染完成       | 地形组件渲染完成时抛出的事件，同时抛出object类型的数据。                                                |
  * 动作

| 动作     | 说明                                                                                                                    |
| ---- | ---- |
| 请求数据接口 | 重新请求服务端数据，上游数据处理节点或图层节点抛出的数据将作为参数。例如地形配置了API数据源为http://api.test，传到请求数据接口动作的数据为{ id: '1'}，则最终请求接口为htp://api.test?id=1。 |
| 导入数据接口 | 按组件绘制格式处理数据后，导入组件，重新绘制。不需要重新请求服务端数据。具体数据示例请参见画布编辑器中组件右侧配置面板数据页签的数据响应结果区域。                                             |
| 显示组件   | 显示组件，不需要参数。                                                                                                           |
| 隐藏组件   | 隐藏组件，不需要参数。                                                                                                           |

## 地形子组件常见问题

Q：当添加地形子组件的同时也添加了道路、建筑或其它组件时，在场景地图中可能会出现地形遮挡建筑、道路等要素的问题，该怎么解决？

A：您可以在场景编辑器中，单击需要调整参数的地形图层，在右侧图层数据面板中，单击重新选择数据按键，打开选择范围对话框，单击右上角的高级配置，在地形子组件参数编辑器内，修改组件的算法参数内容。如下图地形遮挡建筑问题所示，此时需要调整地形算法中的radius参数（默认15m），由于地形起伏变化越大，radius的参数值就需要对应调整的越大（调整成100m），配置参数完成后，即可切回到场景编辑器中，查看解决图层之间遮挡问题后的地图。 

图 1\. 地形和建筑遮挡问题示意图 

![地形和建筑遮挡示意图](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9422458461/p423283.png)

图 2\. 地形子组件参数调整前 

![地形子组件参数调整前](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9422458461/p423284.png)

图 3\. 地形子组件调整参数后 

![地形子组件调整参数后](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/8422458461/p423287.png)

图 4\. 参数调整后遮挡问题解决示意图 

![参数调整后解决遮挡问题示意图](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9422458461/p423294.png)

**说明** 目前建筑、道路、绿地、水系等要素并不是严格匹配地形高度的，所以当前因和地形高度不匹配导致的遮挡的问题，只能够通过参数调整的方式来解决。