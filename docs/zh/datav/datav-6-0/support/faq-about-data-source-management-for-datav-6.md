# 数据源管理常见问题 %{#390172}% 

本文介绍在DataV中连接数据源时，经常遇到的问题及相应的解决方法。

DataV小课堂直播视频：[数据源管理-常见问题](https://cloud.video.taobao.com/play/u/null/p/1/e/6/t/1/d/ud/352172657509.mp4)。

## CSV数据源类问题

### 如何为组件配置CSV数据源？

您可以在DataV控制台单击**我的数据** \> **数据源管理** ，选择**+添加数据**，进入**添加数据**对话框，选择**CSV文件**类型，输入**自定义数据源名称**并上传一个本地电脑中的CSV文件。![添加数据](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/3479351461/p380874.png)上传完成后，您可以在画布编辑器中添加组件，在右侧**数据**面板中的**设置数据源**模块，选择**CSV文件**进行配置，配置成功后，组件将展示为静态数据图表。

**说明** 

上传添加的CSV文件大小不能超过512KB。

## API类问题

### 如何配置API数据源？

在画布编辑器中添加组件，在组件的右侧**数据**面板中，单击**设置数据源**模块，选择**API**进行配置。![设置数据源API](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/4479351461/p380485.png)

**说明** 
* API数据源支持get和post两种请求方式。
* API数据源不用添加，可以直接在画布编辑器中的**数据**面板**设置数据源**模块查找到。

### 在DataV中使用API数据源时，如果遇到跨域的问题，无法正常获取数据时怎么解决？

跨域数据源共享（CORS）是一种基于HTTP头的机制，该机制支持服务器标示除了它自己以外的其它 origin（协议、端口和主机），可以突破浏览器对跨域资源访问的限制，实现跨域资源请求。 如果是简单请求，浏览器会直接发起CORS请求，但可能会出现跨域浏览器控制台console报错；如果是非简单请求，浏览器会先发送预检请求（Preflight request），Preflight request是一个OPTION请求，用于询问要被跨域访问的服务器，从而获知服务端是否允许该跨域请求，服务器确认允许之后，才发起实际的 HTTP 请求。对于在跨域时遇到无法正常获取数据的情况，目前有两种解决方法：

* 方法一：配置数据源时，勾选**服务器代理请求**。![勾选代理请求](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/4479351461/p380535.png)

**说明**  
该方法需要您的接口可以通过外网访问并且返回时间在10s以内，因为服务器代理请求会有10s超时限制。
* 方法二：在数据服务端返回的报头信息中加上`Access-Control-Allow-Origin` 字段。

**说明**  
如果接口数据需要被所有网站使用，您可以使用通配符`*`。

## 数据库类问题

### 如何配置数据库数据源？

在DataV控制台，选择**我的数据** \> **数据源管理**，单击**+添加数据**，在**添加数据**对话框中输入数据库相关配置信息，单击**确定**，即可创建数据库数据源。![添加数据 ](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/3479351461/p380874.png)

**说明** 
* DataV支持自建数据库。
* 直连数据库通过Datav服务端查询，会有10s超时限制，同时，数据库需要能通过外网访问，并配置访问白名单，白名单地址请参见：[配置数据库白名单](https://help.aliyun.com/document%5Fdetail/64686.html)。

如果无法使用外网或不想使用外网访问时，可以使用数据代理服务。对于数据代理服务的适用场景包括：内网数据库、不想开放数据库外网访问和SQL查询耗时较长有10s超时限制的，关于Proxy的获取方式请参见：[DataV Proxy应用使用说明](https://help.aliyun.com/document%5Fdetail/111123.html)。

**说明** 
* 在数据代理服务配置连接数据库时，DataV数据源配置连接数据代理服务，访问可视化应用的计算机，需要能够访问到数据代理服务才能正常看到数据。
* 数据代理服务默认是HTTP的服务，在配置连接或者访问可视化应用时需要用HTTP打开DataV页面。

## 实操演示

### 如何为组件配置CSV数据源？

操作步骤如下：

1. 在DataV控制台选择**我的数据** \> **数据源管理** ，单击**+添加数据**。![添加数据](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/4479351461/p380869.png)
2. 在**添加数据**对话框，类型选择**CSV文件**，输入**自定义数据源名称**，上传CSV文件。![上传CSV文件](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/4479351461/p380881.png)

**说明**  
添加的CSV文件大小不能超过512KB。
3. CSV文件上传完成后，您可以在画布编辑器添加组件，以**基本折线图**组件为例，选中组件，在组件右侧的**数据**面板中的**设置数据源**模块，单击**数据源类型**，选择已经配置好的CSV文件，**选择已有数据源**处将选择CSV进行配置。![选择CSV文件](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/4479351461/p380940.png)

**说明**  
X轴需要在**配置**面板中，将**数据类型**设置为**类目型**。

### 如何配置API数据源？

您可以在画布编辑器内添加一个组件，以**数字翻牌器**组件为例，在组件右侧**数据**面板中的**设置数据源**模块，单击**数据源类型**，选择为API。![设置数据源API ](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/4479351461/p380485.png)

**说明** 

如果遇见报错问题，您需要在浏览器右上角设置中选择**更多工具** \> **开发者工具**，选择Concole查看到关于跨域问题的报错信息，然后在数据服务端返回的报头信息中加上`Access-Control-Allow-Origin` 字段即可处理该跨域问题。

### 如何配置数据库数据源？

1. 在DataV控制台，选择**我的数据** \> **数据源管理** ，单击**+添加数据**。![添加数据](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/4479351461/p380869.png)
2. 在**添加数据**对话框，设置**类型**，选择**RDS for MySQL**，选择**外网**，输入**名称**、**域名**、**端口**、**用户名**和**数据库**等信息，单击**确定**，即可创建数据库数据源。![添加数据库数据源](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/4479351461/p380962.png)
3. 创建完成后，在画布编辑器内添加一个组件，在组件右侧**数据**面板中的**设置数据源**模块，单击**数据源类型**，选择已经配置好的数据库数据源。

**说明**  
如果无法使用外网或不想使用外网访问时，可以按如下步骤操作：

  1. 在DataV控制台，选择**我的数据** \> **数据源管理** ，单击**+添加数据**。
  2. 在添加数据对话框中，设置**类型**，选择**DataV数据代理服务**，**域名**为数据代理服务的域名、**端口**也是数据代理服务的端口，**key**和**Secret**需要将数据代理服务的密钥复制粘贴过来即可。![密钥](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9383249561/p380976.png)
  3. 配置完成后，单击**获取数据列表**，需要注意的是在配置连接或者访问可视化应用时，需要用HTTP打开DataV页面。
  4. 在画布编辑器内选择组件，在组件右侧**数据**面板内的**设置数据源**模块，单击**数据源类型**，选择**数据库**，此时对应的数据源为proxy。